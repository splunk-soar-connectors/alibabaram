{
    "appid": "29b675db-ba53-444c-bd99-dd1304b919fe",
    "name": "Alibaba RAM",
    "description": "This app integrates with Alibaba Resource Access Management (Alibaba RAM) to support various containment, corrective and investigate actions",
    "type": "identity management",
    "product_vendor": "Alibaba",
    "logo": "logo_alibabaram.svg",
    "logo_dark": "logo_alibabaram_dark.svg",
    "product_name": "Alibaba Resource Access Management",
    "product_version_regex": ".*",
    "publisher": "Splunk",
    "license": "Copyright (c) 2019 Splunk Inc.",
    "app_version": "1.0.0",
    "utctime_updated": "2019-07-18T10:00:30.571049Z",
    "package_name": "phantom_alibabaram",
    "main_module": "alibabaram_connector.pyc",
    "min_phantom_version": "4.2.7532",
    "app_wizard_version": "1.0.0",
    "pip_dependencies": {
        "wheel": [
            {
                "module": "aliyunsdkcore",
                "input_file": "wheels/aliyun_python_sdk_core-2.13.5-cp27-none-any.whl"
            },
            {
                "module": "aliyunsdkram",
                "input_file": "wheels/aliyun_python_sdk_ram-3.1.0-cp27-none-any.whl"
            },
            {
                "module": "jmespath",
                "input_file": "wheels/jmespath-0.9.3-py2.py3-none-any.whl"
            }
        ]
    },
    "configuration": {
        "access_key": {
            "description": "Access Key ID",
            "data_type": "password",
            "required": true,
            "order": 0
        },
        "secret_key": {
            "description": "Secret Access key",
            "data_type": "password",
            "required": true,
            "order": 1
        },
        "region_id": {
            "description": "Region ID",
            "data_type": "string",
            "required": true,
            "value_list": [
                "Asia Pacific NE 1",
                "Asia Pacific SE 1",
                "Asia Pacific SE 2",
                "Asia Pacific SE 3",
                "Asia Pacific SE 5",
                "Asia Pacific SOU 1",
                "China East 1",
                "China East 2",
                "China North 1",
                "China North 2",
                "China North 3",
                "China North 5",
                "China South 1",
                "China SW 1",
                "EU Central 1",
                "Hong Kong",
                "Middle East 1",
                "UK (London)",
                "US East 1",
                "US West 1"
            ],
            "default": "China East 1",
            "order": 2
        }
    },
    "actions": [
        {
            "action": "test connectivity",
            "identifier": "test_connectivity",
            "description": "Validate the asset configuration for connectivity using supplied configuration",
            "type": "test",
            "read_only": true,
            "parameters": {},
            "output": [],
            "versions": "EQ(*)"
        },
        {
            "action": "list users",
            "identifier": "list_users",
            "description": "List all the RAM users",
            "type": "investigate",
            "read_only": true,
            "parameters": {
                "limit": {
                    "description": "Maximum number of RAM users to be fetched",
                    "data_type": "numeric",
                    "required": false,
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.data.*.UserName",
                    "data_type": "string",
                    "example_values": [
                        "test1"
                    ],
                    "contains": [
                        "user name"
                    ],
                    "column_name": "User Name",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.DisplayName",
                    "data_type": "string",
                    "example_values": [
                        "test1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.CreateDate",
                    "data_type": "string",
                    "example_values": [
                        "2019-07-19T04:28:48Z"
                    ],
                    "column_name": "Created Date",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.UserId",
                    "data_type": "string",
                    "example_values": [
                        "291581163510528087"
                    ],
                    "column_name": "User ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.Comments",
                    "data_type": "string",
                    "example_values": [
                        "Test Comment"
                    ],
                    "column_name": "Comments",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.UpdateDate",
                    "data_type": "string",
                    "example_values": [
                        "2019-07-19T04:28:48Z"
                    ],
                    "column_name": "Updated Date",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total users: 3"
                    ]
                },
                {
                    "data_path": "action_result.parameter.limit",
                    "data_type": "numeric",
                    "example_values": [
                        100
                    ]
                },
                {
                    "data_path": "action_result.summary.total_users",
                    "data_type": "numeric",
                    "example_values": [
                        3
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list roles",
            "identifier": "list_roles",
            "description": "List all the RAM roles",
            "type": "investigate",
            "read_only": true,
            "parameters": {
                "limit": {
                    "description": "Maximum number of RAM roles to be fetched",
                    "data_type": "numeric",
                    "required": false,
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.data.*.RoleId",
                    "data_type": "string",
                    "example_values": [
                        "386284258992406563"
                    ],
                    "column_name": "Role ID",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.CreateDate",
                    "data_type": "string",
                    "example_values": [
                        "2019-07-19T04:32:18Z"
                    ],
                    "column_name": "Created Date",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.data.*.Description",
                    "data_type": "string",
                    "example_values": [
                        "This is created for testing"
                    ],
                    "column_name": "Role Description",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.Arn",
                    "data_type": "string",
                    "example_values": [
                        "acs:ram::5211362082633686:role/test"
                    ],
                    "column_name": "ARN",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.data.*.RoleName",
                    "data_type": "string",
                    "example_values": [
                        "test"
                    ],
                    "column_name": "Role Name",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total roles: 2"
                    ]
                },
                {
                    "data_path": "action_result.parameter.limit",
                    "data_type": "numeric",
                    "example_values": [
                        100
                    ]
                },
                {
                    "data_path": "action_result.summary.total_roles",
                    "data_type": "numeric",
                    "example_values": [
                        2
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list groups",
            "identifier": "list_groups",
            "description": "List all the RAM user groups",
            "type": "investigate",
            "read_only": true,
            "parameters": {
                "limit": {
                    "description": "Maximum number of RAM user groups to be fetched",
                    "data_type": "numeric",
                    "required": false,
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.data.*.GroupName",
                    "data_type": "string",
                    "example_values": [
                        "alibaba-test-group"
                    ],
                    "column_name": "Group Name",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data.*.CreateDate",
                    "data_type": "string",
                    "example_values": [
                        "2019-07-02T20:39:17Z"
                    ],
                    "column_name": "Created Date",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data.*.UpdateDate",
                    "data_type": "string",
                    "example_values": [
                        "2019-07-02T20:39:17Z"
                    ],
                    "column_name": "Updated Date",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data.*.Comments",
                    "data_type": "string",
                    "example_values": [
                        "Test group for Alibaba"
                    ],
                    "column_name": "Comments",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total groups: 3"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_groups",
                    "data_type": "numeric",
                    "example_values": [
                        3
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "describe group",
            "identifier": "describe_group",
            "description": "List all the policies and the users details for the provided group name",
            "type": "investigate",
            "read_only": true,
            "parameters": {
                "group_name": {
                    "description": "Name of the group",
                    "data_type": "string",
                    "required": true,
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.data.*.users.*.UserName",
                    "data_type": "string",
                    "example_values": [
                        "test_d"
                    ],
                    "contains": [
                        "user name"
                    ]
                },
                {
                    "data_path": "action_result.data.*.users.*.JoinDate",
                    "data_type": "string",
                    "example_values": [
                        "2019-07-19T04:29:03Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.users.*.DisplayName",
                    "data_type": "string",
                    "example_values": [
                        "test_d"
                    ]
                },
                {
                    "data_path": "action_result.data.*.policies.*.AttachDate",
                    "data_type": "string",
                    "example_values": [
                        "2019-07-19T04:29:45Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.policies.*.DefaultVersion",
                    "data_type": "string",
                    "example_values": [
                        "v2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.policies.*.PolicyType",
                    "data_type": "string",
                    "example_values": [
                        "System"
                    ]
                },
                {
                    "data_path": "action_result.data.*.policies.*.Description",
                    "data_type": "string",
                    "example_values": [
                        "\u53ea\u8bfb\u8bbf\u95ee\u6240\u6709\u963f\u91cc\u4e91\u8d44\u6e90\u7684\u6743\u9650"
                    ]
                },
                {
                    "data_path": "action_result.data.*.policies.*.PolicyName",
                    "data_type": "string",
                    "example_values": [
                        "ReadOnlyAccess"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total policies: 2, Total users: 2"
                    ]
                },
                {
                    "data_path": "action_result.parameter.group_name",
                    "data_type": "string",
                    "example_values": [
                        "test1"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_policies",
                    "data_type": "numeric",
                    "example_values": [
                        2
                    ]
                },
                {
                    "data_path": "action_result.summary.total_users",
                    "data_type": "numeric",
                    "example_values": [
                        2
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "custom",
                "width": 10,
                "height": 10,
                "title": "Group Info",
                "view": "alibabaram_view.display_view"

            },
            "versions": "EQ(*)"
        },
        {
            "action": "list user groups",
            "identifier": "list_user_groups",
            "description": "Get the groups that the user is a member of",
            "type": "investigate",
            "read_only": true,
            "parameters": {
                "username": {
                    "description": "Username (to get goups it belongs to)",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "user name"
                    ],
                    "value_list": [],
                    "default": "",
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "column_name": "status",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.parameter.username",
                    "data_type": "string",
                    "contains": [
                        "user name"
                    ],
                    "column_name": "username",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric"
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric"
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "attach policy",
            "identifier": "attach_policy",
            "description": "Attaches a policy to a RAM User, Group or Role",
            "type": "generic",
            "read_only": false,
            "parameters": {
                "group_name": {
                    "description": "RAM group name",
                    "data_type": "string",
                    "required": false,
                    "primary": false,
                    "contains": [],
                    "value_list": [],
                    "default": "",
                    "order": 0
                },
                "role_name": {
                    "description": "RAM role name",
                    "data_type": "string",
                    "required": false,
                    "primary": false,
                    "contains": [],
                    "value_list": [],
                    "default": "",
                    "order": 1
                },
                "username": {
                    "description": "RAM username",
                    "data_type": "string",
                    "required": false,
                    "primary": false,
                    "contains": [],
                    "value_list": [],
                    "default": "",
                    "order": 2
                },
                "policy_name": {
                    "description": "RAM policy name",
                    "data_type": "string",
                    "required": true,
                    "primary": false,
                    "contains": [],
                    "value_list": [],
                    "default": "",
                    "order": 3
                },
                "policy_type": {
                    "description": "RAM policy type",
                    "data_type": "string",
                    "required": true,
                    "primary": false,
                    "contains": [],
                    "value_list": [
                        "System",
                        "Custom"
                    ],
                    "default": "",
                    "order": 4
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "column_name": "status",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.parameter.group_name",
                    "data_type": "string",
                    "contains": [],
                    "column_name": "group_name",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.parameter.policy_name",
                    "data_type": "string",
                    "contains": [],
                    "column_name": "policy_name",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.parameter.policy_type",
                    "data_type": "string",
                    "contains": [],
                    "column_name": "policy_type",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.parameter.role_name",
                    "data_type": "string",
                    "contains": [],
                    "column_name": "role_name",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.parameter.username",
                    "data_type": "string",
                    "contains": [],
                    "column_name": "username",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric"
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric"
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "update user",
            "identifier": "update_user",
            "description": "Updates the basic information about a RAM user",
            "type": "generic",
            "read_only": false,
            "parameters": {
                "username": {
                    "description": "RAM User name",
                    "data_type": "string",
                    "required": true,
                    "primary": false,
                    "contains": [],
                    "value_list": [],
                    "default": "",
                    "order": 0
                },
                "comment": {
                    "description": "The comment on the new RAM user",
                    "data_type": "string",
                    "required": false,
                    "primary": false,
                    "contains": [],
                    "value_list": [],
                    "default": "",
                    "order": 1
                },
                "email": {
                    "description": "Updated Email of the RAM user",
                    "data_type": "string",
                    "required": false,
                    "primary": false,
                    "contains": [],
                    "value_list": [],
                    "default": "",
                    "order": 2
                },
                "mobile_number": {
                    "description": "Updated mobile number of the RAM user",
                    "data_type": "string",
                    "required": false,
                    "primary": false,
                    "contains": [],
                    "value_list": [],
                    "default": "",
                    "order": 3
                },
                "new_username": {
                    "description": "Updated username of the RAM user",
                    "data_type": "string",
                    "required": false,
                    "primary": false,
                    "contains": [],
                    "value_list": [],
                    "default": "",
                    "order": 4
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "column_name": "status",
                    "column_order": 5
                },
                {
                    "data_path": "action_result.parameter.comment",
                    "data_type": "string",
                    "contains": [],
                    "column_name": "comment",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.parameter.email",
                    "data_type": "string",
                    "contains": [],
                    "column_name": "email",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.parameter.mobile_number",
                    "data_type": "string",
                    "contains": [],
                    "column_name": "mobile_number",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.parameter.new_username",
                    "data_type": "string",
                    "contains": [],
                    "column_name": "new_username",
                    "column_order": 4
                },
                {
                    "data_path": "action_result.parameter.username",
                    "data_type": "string",
                    "contains": [],
                    "column_name": "username",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric"
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric"
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        }
    ]
}